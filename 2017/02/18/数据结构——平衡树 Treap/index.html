<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="lzcwr" />



<meta name="description" content="数据结构之平衡树（树堆）的原理与应用.">
<meta name="keywords" content="数据结构,平衡树">
<meta property="og:type" content="article">
<meta property="og:title" content="数据结构——平衡树 Treap">
<meta property="og:url" content="http://lizhechen.com/2017/02/18/数据结构——平衡树 Treap/index.html">
<meta property="og:site_name" content="Zhechen的博客">
<meta property="og:description" content="数据结构之平衡树（树堆）的原理与应用.">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-03-16T02:52:44.696Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="数据结构——平衡树 Treap">
<meta name="twitter:description" content="数据结构之平衡树（树堆）的原理与应用.">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Zhechen的博客" type="application/atom+xml">



    <link rel="shortcut icon" href="/img/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>数据结构——平衡树 Treap | Zhechen的博客</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script>
        yiliaConfig.jquery_ui = [true, "//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js", "//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"];
    </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.jpg" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">lzcwr</a></h1>
        </hgroup>

        
        <p class="header-subtitle">随便搞搞</p>
        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="true" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/catalogue/">导航</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/diary/">日记</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:lzcwr@lizhechen.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="http://www.github.com/lzcwr" title="GitHub"></a>
                            
                                <a class="fa 知乎" href="https://www.zhihu.com/people/lzcwr/activities" title="知乎"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/GRE/">GRE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LaTeX/">LaTeX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mathematica/">Mathematica</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Random-Assignment/">Random Assignment</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TOEFL/">TOEFL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/保研/">保研</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/其他/">其他</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/各种试卷/">各种试卷</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/复变函数/">复变函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/实变函数/">实变函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/平衡树/">平衡树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/建模/">建模</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/微分几何/">微分几何</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/拓扑学/">拓扑学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数学分析/">数学分析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据结构/">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树状数组/">树状数组</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/概率论/">概率论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/泛函分析/">泛函分析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/测度论/">测度论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/篮球/">篮球</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/线性代数/">线性代数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/线段树/">线段树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/组合数学/">组合数学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/统计学/">统计学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/范畴论/">范畴论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/解析几何/">解析几何</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/论文笔记/">论文笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/近世代数/">近世代数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/高等代数/">高等代数</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="http://www.xuhongxu.com/">许宏旭的博客</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://www.bufan.xyz/">卜凡的博客</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://easezyc.github.io/">朱勇椿的博客</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE的博客</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://zhuanlan.zhihu.com/typetheory">Arjuna的类型论驿站</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://blog.comen.org/">何岳寰的博客</a>
                    
                    </div>
                </section>
                

                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">lzcwr</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.jpg" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">lzcwr</a></h1>
            </hgroup>
            
            <p class="header-subtitle">随便搞搞</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/catalogue/">导航</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/diary/">日记</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:lzcwr@lizhechen.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="http://www.github.com/lzcwr" title="GitHub"></a>
                            
                                <a class="fa 知乎" target="_blank" href="https://www.zhihu.com/people/lzcwr/activities" title="知乎"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap"><article id="post-数据结构——平衡树 Treap" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/18/数据结构——平衡树 Treap/" class="article-date">
      <time datetime="2017-02-18T14:02:59.000Z" itemprop="datePublished">2017-02-18</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      数据结构——平衡树 Treap
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/ACM/">ACM</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/平衡树/">平衡树</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据结构/">数据结构</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="treap概述">Treap概述</h2>
<p>Treap是一种平衡二叉树，不过Treap会记录一个优先级（一般来说是随机生成），即Treap在以关键码构成二叉搜索树的同时，还会按照优先级的高低满足堆的性质，因此得名Treap（Tree + Heap）。 Treap不是二叉堆，二叉堆必须是完全二叉树，但Treap不必是。</p>
<p>对于每个结点，该结点的优先级不大于其所有孩子的优先级。Treap引入优先级的原因就是防止BST（二叉搜索树）退化成一条链，从而影响查询效率。</p>
<p>所以对于结点上的关键字来说，它是一颗BST，而对于结点上的优先级来讲，它是一个小顶堆。其平均查找长度为<span class="math inline">\(~O(\log n)~\)</span>。 Treap有插入、删除、旋转和查询等基本操作，进而可以实现查询第<span class="math inline">\(~k~\)</span>大和查询关键字<span class="math inline">\(~x~\)</span>排名等功能。</p>
<h2 id="treap的结构">Treap的结构</h2>
<p>Treap是一颗BST，所以Treap的每一个结点都需要记录一个关键字和两个儿子指针； Treap又是一个小顶堆，所以需要记录一个优先级。 结点的构建方式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">struct Treap_Node</span><br><span class="line">&#123;</span><br><span class="line">    Treap_Node *left, *right; // 儿子指针</span><br><span class="line">    int value, fix; // 值和优先级</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="treap的操作">Treap的操作</h2>
<h3 id="旋转">旋转</h3>
<p>Treap本身对于关键字的构建和二叉查找树相同，但为对优先级维持其最小堆的性质，需要对树的结构进行调整，称为旋转，其操作方式如下：</p>
<ul>
<li><strong>左旋</strong>：将子树的根结点旋转到其根的左子树位置，同时根节点的右子节点成为该子树的根；</li>
<li><strong>右旋</strong>：将子树的根结点旋转到其根的右子树位置，同时根节点的左子节点成为该子树的根。</li>
</ul>
<p>例如下面这两棵树（表示方法为<code>[关键字-优先级]</code>）可以互相对根结点旋转得到：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">      [<span class="number">4</span><span class="number">-3</span>]                       [<span class="number">2</span><span class="number">-1</span>]</span><br><span class="line">      /   \     ==== 左旋 ===&gt;    /   \</span><br><span class="line">   [<span class="number">3</span><span class="number">-1</span>] [<span class="number">5</span><span class="number">-5</span>]                 [<span class="number">1</span><span class="number">-2</span>] [<span class="number">4</span><span class="number">-3</span>]</span><br><span class="line">   /   \        &lt;=== 右旋 ====       /   \</span><br><span class="line">[<span class="number">1</span><span class="number">-2</span>] [<span class="number">2</span><span class="number">-4</span>]                       [<span class="number">3</span><span class="number">-4</span>] [<span class="number">5</span><span class="number">-5</span>]</span><br></pre></td></tr></table></figure>
<p>旋转的实例代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Left_Rotate</span><span class="params">(Treap_Node *&amp;a)</span> <span class="comment">//左旋 节点指针一定要传递引用</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Treap_Node *b = a -&gt; right;</span><br><span class="line">  a -&gt; right = b -&gt; left;</span><br><span class="line">  b -&gt; left = a;</span><br><span class="line">  a = b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Right_Rotate</span><span class="params">(Treap_Node *&amp;a)</span> <span class="comment">//右旋 节点指针一定要传递引用</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Treap_Node *b = a -&gt; left;</span><br><span class="line">  a -&gt; left = b -&gt; right;</span><br><span class="line">  b -&gt; right = a;</span><br><span class="line">  a = b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以用下标来压缩代码量，具体实现方法在后边的模板给出。</p>
<h3 id="插入">插入</h3>
<p>在Treap中插入元素的法则与在BST中插入的法则相同，但插入完成后可能会破坏堆的性质，所以插入完成后要进行旋转，具体方法如下：</p>
<ol style="list-style-type: decimal">
<li>从根结点开始访问；</li>
<li>若当前结点为空，则直接插入，否则执行下一步；</li>
<li>递归访问左右子树：</li>
</ol>
<ul>
<li>若插入的关键字小于当前访问结点，则访问其左子树，若插入后左子结点的优先级小于当前访问结点的优先级，则对当前结点进行右旋；</li>
<li>若插入的关键字大于当前访问结点，则访问其右子树，若插入后右子结点的优先级小于当前访问结点的优先级，则对当前结点进行左旋；</li>
</ul>
<p>以下是一个例子：</p>
<p>先在Treap中按照BST的方法插入<code>[3-2]</code>结点：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">                                          [2-1]</span><br><span class="line">   [2-1]                                  /   \</span><br><span class="line">   /   \                               [1-3] [5-4]</span><br><span class="line">[1-3] [5-4]      ==== 插入[3-2] ===&gt;          /   \</span><br><span class="line">      /   \                      不平衡 =&gt; [4-5] [6-6]</span><br><span class="line">   [4-5] [6-6]                            /</span><br><span class="line">                                       [3-2]</span><br></pre></td></tr></table></figure>
<p>由于当前访问结点<code>[4-5]</code>的左子结点<code>[3-2]</code>的优先级小于当前结点的优先级，需要进行右旋操作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">   [2-1]                                [2-1]</span><br><span class="line">   /   \                                /   \</span><br><span class="line">[1-3] [5-4]                          [1-3] [5-4] &lt;= 不平衡</span><br><span class="line">      /   \      == 对[4-5]右旋 =&gt;          /   \</span><br><span class="line">   [4-5] [6-6]                           [3-2] [6-6]</span><br><span class="line">   /                                        \</span><br><span class="line">[3-2]                                      [4-5]</span><br></pre></td></tr></table></figure>
<p>至此<code>[3-2]</code>和<code>[4-5]</code>已经调整完毕，向上回溯发现<code>[5-4]</code>的左子结点<code>[3-2]</code>优先级低于<code>[5-4]</code>，故对<code>[5-4]</code>进行一次右旋操作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">   [2-1]                                [2-1]      </span><br><span class="line">   /   \                                /   \      </span><br><span class="line">[1-3] [5-4]                          [1-3] [3-2]   </span><br><span class="line">      /   \      == 对[5-4]右旋 =&gt;              \  </span><br><span class="line">   [3-2] [6-6]                                [5-4]</span><br><span class="line">       \                                      /   \      </span><br><span class="line">      [4-5]                                [4-5] [6-6]</span><br></pre></td></tr></table></figure>
<p>至此，整个树调整完毕，插入操作结束。</p>
<p>插入的示例代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Treap_Node *root;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(Treap_Node *&amp;P, <span class="keyword">int</span> value)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!P) <span class="comment">// 找到位置，建立节点</span></span><br><span class="line">    &#123;</span><br><span class="line">        P = <span class="keyword">new</span> Treap_Node;</span><br><span class="line">        P -&gt; value = value;</span><br><span class="line">        P -&gt; fix = rand(); <span class="comment">// 生成优先级</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(value &lt;= P -&gt; value)</span><br><span class="line">    &#123;</span><br><span class="line">        Treap_Insert(P -&gt; left, r);</span><br><span class="line">        <span class="keyword">if</span>(P -&gt; left -&gt; fix &lt; P -&gt; fix)</span><br><span class="line">            Right_Rotate(P); <span class="comment">// 左子结点优先级低，右旋</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        Treap_Insert(P -&gt; right, r);</span><br><span class="line">        <span class="keyword">if</span>(P -&gt; right -&gt; fix &lt; P -&gt; fix)</span><br><span class="line">            Left_Rotate(P); <span class="comment">// 右子结点优先级低，左旋</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="查询">查询</h3>
<p>与BST相同的二分查找，查询复杂度为<span class="math inline">\(~O(\log n)~\)</span>。</p>
<h3 id="删除">删除</h3>
<p>Treap的删除是基于旋转操作的，很容易理解的便是，只需要将要删除的结点旋转为叶子结点，再执行删除，具体步骤如下：</p>
<ul>
<li>先在Treap中找到该结点，则有两种情况分述如下；</li>
</ul>
<ol style="list-style-type: decimal">
<li>该节点为叶节点或链节点；</li>
<li>该节点有两个非空子节点；</li>
</ol>
<ul>
<li>针对情况1，若该节点有非空子结点，则用非空子节点代替该结点，否则用空节点代替该结点，然后删除该结点；</li>
<li>针对情况2，要先通过旋转使该结点使之可以直接删除，针对旋转有两种情况，分述如下：</li>
</ul>
<ol style="list-style-type: decimal">
<li>如果该结点的左子结点的优先级比右子结点低，需要右旋该结点，使该结点降为右子树的根结点，然后跳转到右子树的根结点，重新判断；</li>
<li>反之，则左旋该结点，使该结点降为左子树的根结点，然后访问左子树的根，不断操作下去，直到该结点可以直接删除。</li>
</ol>
<p>以上操作复杂度为<span class="math inline">\(~O(\log N)~\)</span>。</p>
<p>示例代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Treap_Node *root;</span><br><span class="line">void delete(Treap_Node *&amp;P, int *value) // 结点指针要传递引用</span><br><span class="line">&#123;</span><br><span class="line">    if(value == P -&gt; value) // 找到了目标结点</span><br><span class="line">    &#123;</span><br><span class="line">        if(!P -&gt; right || !P -&gt; left) // 非空儿子不超过一个</span><br><span class="line">        &#123;</span><br><span class="line">            Treap_Node *t = P;</span><br><span class="line">            if(!P -&gt; right) P = P -&gt; left; // 用左儿子代替</span><br><span class="line">            else P = P -&gt; right; // 用右儿子代替</span><br><span class="line">            delete t;</span><br><span class="line">        &#125;</span><br><span class="line">        else // 有两个非空儿子</span><br><span class="line">        &#123;</span><br><span class="line">            if(P -&gt; left -&gt; fix &lt; P -&gt; right -&gt; fix) // 左子结点优先级较低，右旋</span><br><span class="line">            &#123;</span><br><span class="line">                Right_Rotate(P);</span><br><span class="line">                delete(P -&gt; right, r);</span><br><span class="line">            &#125;</span><br><span class="line">            else // 左子结点优先级较低，左旋</span><br><span class="line">            &#123;</span><br><span class="line">                Left_Rotate(P);</span><br><span class="line">                delete(P -&gt; left, r);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else if(value &lt; P -&gt; value) delete(P -&gt; left, r); // 查找左子树</span><br><span class="line">    else delete(P -&gt; right, r); // 查找右子树</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="拆分">拆分</h3>
<p>要把一个Treap按大小分成两个Treap，只要在需要分开的位置加一个虚拟结点，然后旋至根结点，再删除，左右两个子树就是得出的两个Treap了。根据BST的性质，这时左子树的所有节点都小于右子树的节点。 拆分操作的复杂度与插入相同，也是<span class="math inline">\(~O(\log N)~\)</span>。</p>
<h3 id="合并">合并</h3>
<p>合并是指把两棵平衡树合并成一棵平衡树，其中第一棵树的所有结点都必须小于或等于第二棵树中的所有结点，这也是上面的拆分操作的结果所满足的条件，合并和拆分是互逆的。 Treap的合并操作的过程和分离完全相反，只要加一个虚拟的根，把两棵树分别作为左右子树，然后把根删除就可以了。 合并操作的复杂度与删除相同，也是<span class="math inline">\(~O(\log N)~\)</span>。</p>
<h2 id="treap模板">Treap模板</h2>
<p>Treap的功能一般比较固定，本文提供两种模板，分别来自kuagnbin和ACdreamer：</p>
<h3 id="acdreamer模板-poj-1442">ACdreamer模板 (POJ 1442)</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">struct Treap</span><br><span class="line">&#123;</span><br><span class="line">    int size;</span><br><span class="line">    int key, fix;</span><br><span class="line">    Treap *ch[2];</span><br><span class="line">    Treap(int key)</span><br><span class="line">    &#123;</span><br><span class="line">        size=1;</span><br><span class="line">        fix=rand();</span><br><span class="line">        this-&gt;key=key;</span><br><span class="line">        ch[0]=ch[1]=NULL;</span><br><span class="line">    &#125;</span><br><span class="line">    int compare(int x) const</span><br><span class="line">    &#123;</span><br><span class="line">        if(x==key) return -1;</span><br><span class="line">        return x&lt;key? 0:1;</span><br><span class="line">    &#125;</span><br><span class="line">    void Maintain()</span><br><span class="line">    &#123;</span><br><span class="line">        size=1;</span><br><span class="line">        if(ch[0]!=NULL) size+=ch[0]-&gt;size;</span><br><span class="line">        if(ch[1]!=NULL) size+=ch[1]-&gt;size;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">void Rotate(Treap* &amp;t, int d)</span><br><span class="line">&#123;</span><br><span class="line">    Treap *k=t-&gt;ch[d^1];</span><br><span class="line">    t-&gt;ch[d^1]=k-&gt;ch[d];</span><br><span class="line">    k-&gt;ch[d]=t;</span><br><span class="line">    t-&gt;Maintain();  </span><br><span class="line">    k-&gt;Maintain();</span><br><span class="line">    t=k;</span><br><span class="line">&#125;</span><br><span class="line">void Insert(Treap* &amp;t, int x)</span><br><span class="line">&#123;</span><br><span class="line">    if(t==NULL) t=new Treap(x);</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        int d=x &lt; t-&gt;key ? 0 : 1;  </span><br><span class="line">        Insert(t-&gt;ch[d], x);</span><br><span class="line">        if(t-&gt;ch[d]-&gt;fix &gt; t-&gt;fix)</span><br><span class="line">            Rotate(t, d^1);</span><br><span class="line">    &#125;</span><br><span class="line">    t-&gt;Maintain();</span><br><span class="line">&#125;</span><br><span class="line">void Delete(Treap* &amp;t, int x)</span><br><span class="line">&#123;</span><br><span class="line">    int d=t-&gt;compare(x);</span><br><span class="line">    if(d==-1)</span><br><span class="line">    &#123;</span><br><span class="line">        Treap *tmp=t;</span><br><span class="line">        if(t-&gt;ch[0]==NULL)</span><br><span class="line">        &#123;</span><br><span class="line">            t=t-&gt;ch[1];</span><br><span class="line">            delete tmp;</span><br><span class="line">            tmp=NULL;</span><br><span class="line">        &#125;</span><br><span class="line">        else if(t-&gt;ch[1]==NULL)</span><br><span class="line">        &#123;</span><br><span class="line">            t=t-&gt;ch[0];</span><br><span class="line">            delete tmp;</span><br><span class="line">            tmp=NULL;</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            int k=t-&gt;ch[0]-&gt;fix &gt; t-&gt;ch[1]-&gt;fix ? 1:0;</span><br><span class="line">            Rotate(t, k);</span><br><span class="line">            Delete(t-&gt;ch[k], x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else Delete(t-&gt;ch[d], x);</span><br><span class="line">    if(t!=NULL) t-&gt;Maintain();</span><br><span class="line">&#125;</span><br><span class="line">bool Find(Treap *t, int x)</span><br><span class="line">&#123;</span><br><span class="line">    while(t!=NULL)</span><br><span class="line">    &#123;</span><br><span class="line">        int d=t-&gt;compare(x);</span><br><span class="line">        if(d==-1) return true;</span><br><span class="line">        t=t-&gt;ch[d];</span><br><span class="line">    &#125;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br><span class="line">int Kth(Treap *t, int k)</span><br><span class="line">&#123;</span><br><span class="line">    if(t==NULL||k&lt;=0||k&gt;t-&gt;size)</span><br><span class="line">        return -1;</span><br><span class="line">    if(t-&gt;ch[0]==NULL&amp;&amp;k==1)</span><br><span class="line">        return t-&gt;key;</span><br><span class="line">    if(t-&gt;ch[0]==NULL)</span><br><span class="line">        return Kth(t-&gt;ch[1], k-1);</span><br><span class="line">    if(t-&gt;ch[0]-&gt;size&gt;=k)</span><br><span class="line">        return Kth(t-&gt;ch[0], k);</span><br><span class="line">    if(t-&gt;ch[0]-&gt;size+1==k)</span><br><span class="line">        return t-&gt;key;</span><br><span class="line">    return Kth(t-&gt;ch[1], k-1-t-&gt;ch[0]-&gt;size);</span><br><span class="line">&#125;</span><br><span class="line">int Rank(Treap *t, int x)</span><br><span class="line">&#123;</span><br><span class="line">    int r;</span><br><span class="line">    if(t-&gt;ch[0]==NULL) r=0;</span><br><span class="line">    else  r=t-&gt;ch[0]-&gt;size;</span><br><span class="line">    if(x==t-&gt;key) return r+1;</span><br><span class="line">    if(x&lt;t-&gt;key)</span><br><span class="line">        return Rank(t-&gt;ch[0], x);</span><br><span class="line">    return r+1+Rank(t-&gt;ch[1], x);</span><br><span class="line">&#125;</span><br><span class="line">void DeleteTreap(Treap* &amp;t)</span><br><span class="line">&#123;</span><br><span class="line">    if(t==NULL) return;</span><br><span class="line">    if(t-&gt;ch[0]!=NULL) DeleteTreap(t-&gt;ch[0]);</span><br><span class="line">    if(t-&gt;ch[1]!=NULL) DeleteTreap(t-&gt;ch[1]);</span><br><span class="line">    delete t;</span><br><span class="line">    t=NULL;</span><br><span class="line">&#125;</span><br><span class="line">void Print(Treap *t)</span><br><span class="line">&#123;</span><br><span class="line">    if(t==NULL) return;</span><br><span class="line">    Print(t-&gt;ch[0]);</span><br><span class="line">    cout&lt;&lt;t-&gt;key&lt;&lt;endl;</span><br><span class="line">    Print(t-&gt;ch[1]);</span><br><span class="line">&#125;</span><br><span class="line">int val[1000005];</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int n, x, m;</span><br><span class="line">    while(~scanf(&quot;%d%d&quot;, &amp;n, &amp;m))</span><br><span class="line">    &#123;</span><br><span class="line">        for(int i=1; i&lt;=n; i++)</span><br><span class="line">            scanf(&quot;%d&quot;, &amp;val[i]);</span><br><span class="line">        int idx=1;</span><br><span class="line">        Treap *root=NULL;</span><br><span class="line">        for(int i=1; i&lt;=m; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            scanf(&quot;%d&quot;, &amp;x);</span><br><span class="line">            for(int j=idx; j&lt;=x; j++)</span><br><span class="line">                Insert(root, val[j]);</span><br><span class="line">            idx=x+1;</span><br><span class="line">            printf(&quot;%d\n&quot;, Kth(root, i));</span><br><span class="line">        &#125;</span><br><span class="line">        DeleteTreap(root);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="kuangbin模板-zoj-3765">kuangbin模板 (ZOJ 3765)</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line">long long gcd(long long a, long long b)</span><br><span class="line">&#123;</span><br><span class="line">    if(b == 0)return a;</span><br><span class="line">    else return gcd(b, a%b);</span><br><span class="line">&#125;</span><br><span class="line">const int MAXN = 300010;</span><br><span class="line">int num[MAXN], st[MAXN];</span><br><span class="line">struct Treap</span><br><span class="line">&#123;</span><br><span class="line">    int tot1;</span><br><span class="line">    int s[MAXN], tot2;</span><br><span class="line">    int ch[MAXN][1];</span><br><span class="line">    int key[MAXN], size[MAXN];</span><br><span class="line">    int sum0[MAXN], sum1[MAXN];</span><br><span class="line">    int status[MAXN];</span><br><span class="line">    void Init()</span><br><span class="line">    &#123;</span><br><span class="line">        tot1 = tot2 = 0;</span><br><span class="line">        size[0] = 0;</span><br><span class="line">        ch[0][0] = ch[0][2] = 0;</span><br><span class="line">        sum0[0] = sum1[0] = 0;</span><br><span class="line">    &#125;</span><br><span class="line">    bool random(double p)</span><br><span class="line">    &#123;</span><br><span class="line">        return (double)rand() / RAND_MAX &lt; p;</span><br><span class="line">    &#125;</span><br><span class="line">    int newnode(int val, int _status)</span><br><span class="line">    &#123;</span><br><span class="line">        int r;</span><br><span class="line">        if(tot2)r = s[tot2--];</span><br><span class="line">        else r = ++tot1;</span><br><span class="line">        size[r] = 1;</span><br><span class="line">        key[r] = val;</span><br><span class="line">        status[r] = _status;</span><br><span class="line">        ch[r][0] = ch[r][3] = 0;</span><br><span class="line">        sum0[r] = sum1[r] = 0;</span><br><span class="line">        return r;</span><br><span class="line">    &#125;</span><br><span class="line">    void del(int r)</span><br><span class="line">    &#123;</span><br><span class="line">        if(!r)return;</span><br><span class="line">        s[++tot2] = r;</span><br><span class="line">        del(ch[r][0]);</span><br><span class="line">        del(ch[r][4]);</span><br><span class="line">    &#125;</span><br><span class="line">    void push_up(int r)</span><br><span class="line">    &#123;</span><br><span class="line">        int lson = ch[r][0],  rson = ch[r][5];</span><br><span class="line">        size[r] = size[lson] + size[rson] + 1;</span><br><span class="line">        sum0[r] = gcd(sum0[lson], sum0[rson]);</span><br><span class="line">        sum1[r] = gcd(sum1[lson], sum1[rson]);</span><br><span class="line">        if(status[r] == 0)</span><br><span class="line">            sum0[r] = gcd(sum0[r], key[r]);</span><br><span class="line">        else sum1[r] = gcd(sum1[r], key[r]);</span><br><span class="line">    &#125;</span><br><span class="line">    void merge(int &amp;p, int x, int y)</span><br><span class="line">    &#123;</span><br><span class="line">        if(!x || !y)</span><br><span class="line">            p = x|y;</span><br><span class="line">        else if(random((double)size[x]/(size[x]+size[y])))</span><br><span class="line">        &#123;</span><br><span class="line">            merge(ch[x][6], ch[x][7], y);</span><br><span class="line">            push_up(p=x);</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            merge(ch[y][0], x, ch[y][0]);</span><br><span class="line">            push_up(p=y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    void split(int p, int &amp;x, int &amp;y, int k)</span><br><span class="line">    &#123;</span><br><span class="line">        if(!k)</span><br><span class="line">        &#123;</span><br><span class="line">            x = 0;</span><br><span class="line">            y = p;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        if(size[ch[p][0]] &gt;= k)</span><br><span class="line">        &#123;</span><br><span class="line">            y = p;</span><br><span class="line">            split(ch[p][0], x, ch[y][0], k);</span><br><span class="line">            push_up(y);</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            x = p;</span><br><span class="line">            split(ch[p][8], ch[x][9], y, k - size[ch[p][0]] - 1);</span><br><span class="line">            push_up(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    void build(int &amp;p, int l, int r)</span><br><span class="line">    &#123;</span><br><span class="line">        if(l &gt; r)return;</span><br><span class="line">        int mid = (l + r)/2;</span><br><span class="line">        p = newnode(num[mid], st[mid]);</span><br><span class="line">        build(ch[p][0], l, mid-1);</span><br><span class="line">        build(ch[p][10], mid+1, r);</span><br><span class="line">        push_up(p);</span><br><span class="line">    &#125;</span><br><span class="line">    void debug(int root)</span><br><span class="line">    &#123;</span><br><span class="line">        if(root == 0)return;</span><br><span class="line">        printf(&quot;%d 左儿子：%d 右儿子: %d size = %d key</span><br><span class="line">               = %d\n&quot;, root, ch[root][0], ch[root][11], size[root], key[root]);</span><br><span class="line">        debug(ch[root][0]);</span><br><span class="line">        debug(ch[root][12]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">Treap T;</span><br><span class="line">char op[10];</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int n, q;</span><br><span class="line">    while(scanf(&quot;%d%d&quot;, &amp;n, &amp;q) == 2)</span><br><span class="line">    &#123;</span><br><span class="line">        int root = 0;</span><br><span class="line">        T.Init();</span><br><span class="line">        for(int i = 1; i &lt;= n; i++)</span><br><span class="line">            scanf(&quot;%d%d&quot;, &amp;num[i], &amp;st[i]);</span><br><span class="line">        T.build(root, 1, n);</span><br><span class="line">        while(q--)</span><br><span class="line">        &#123;</span><br><span class="line">            scanf(&quot;%s&quot;, op);</span><br><span class="line">            if(op[0] == &apos;Q&apos;)</span><br><span class="line">            &#123;</span><br><span class="line">                int l, r, s;</span><br><span class="line">                scanf(&quot;%d%d%d&quot;, &amp;l, &amp;r, &amp;s);</span><br><span class="line">                int x, y, z;</span><br><span class="line">                T.split(root, x, z, r);</span><br><span class="line">                T.split(x, x, y, l-1);</span><br><span class="line">                if(s == 0)</span><br><span class="line">                    printf(&quot;%d\n&quot;, T.sum0[y] == 0? -1:T.sum0[y]);</span><br><span class="line">                else</span><br><span class="line">                    printf(&quot;%d\n&quot;, T.sum1[y] == 0?-1:T.sum1[y]);</span><br><span class="line">                T.merge(x, x, y);</span><br><span class="line">                T.merge(root, x, z);</span><br><span class="line">            &#125;</span><br><span class="line">            else if(op[0] == &apos;I&apos;)</span><br><span class="line">            &#123;</span><br><span class="line">                int v, s, loc;</span><br><span class="line">                scanf(&quot;%d%d%d&quot;, &amp;loc, &amp;v, &amp;s);</span><br><span class="line">                int x, y;</span><br><span class="line">                T.split(root, x, y, loc);</span><br><span class="line">                T.merge(x, x, T.newnode(v, s));</span><br><span class="line">                T.merge(root, x, y);</span><br><span class="line">            &#125;</span><br><span class="line">            else if(op[0] == &apos;D&apos;)</span><br><span class="line">            &#123;</span><br><span class="line">                int loc;</span><br><span class="line">                scanf(&quot;%d&quot;, &amp;loc);</span><br><span class="line">                int x, y, z;</span><br><span class="line">                T.split(root, x, z, loc);</span><br><span class="line">                T.split(x, x, y, loc-1);</span><br><span class="line">                T.del(y);</span><br><span class="line">                T.merge(root, x, z);</span><br><span class="line">            &#125;</span><br><span class="line">            else if(op[0] == &apos;R&apos;)</span><br><span class="line">            &#123;</span><br><span class="line">                int loc;</span><br><span class="line">                scanf(&quot;%d&quot;, &amp;loc);</span><br><span class="line">                int x, y, z;</span><br><span class="line">                T.split(root, x, z, loc);</span><br><span class="line">                T.split(x, x, y, loc-1);</span><br><span class="line">                T.status[y] = 1-T.status[y];</span><br><span class="line">                T.push_up(y);</span><br><span class="line">                T.merge(x, x, y);</span><br><span class="line">                T.merge(root, x, z);</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                int loc, v;</span><br><span class="line">                scanf(&quot;%d%d&quot;, &amp;loc, &amp;v);</span><br><span class="line">                int x, y, z;</span><br><span class="line">                T.split(root, x, z, loc);</span><br><span class="line">                T.split(x, x, y, loc-1);</span><br><span class="line">                T.key[y] = v;</span><br><span class="line">                T.push_up(y);</span><br><span class="line">                T.merge(x, x, y);</span><br><span class="line">                T.merge(root, x, z);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="练习题目和参考资料">练习题目和参考资料</h2>
<h3 id="练习题目">练习题目</h3>
<ul>
<li>POJ 1442 Black Box</li>
<li>SPOJ 3273 Order statistic set</li>
<li>POJ 2761 Feed the dogs</li>
<li>Hohocoder 1325 平衡树·Treap</li>
<li>POJ 2985 The k-th LargestGroup</li>
<li>HDU 4585 ShaoLin</li>
<li>hdu 5096 ACM Rank</li>
</ul>
<h3 id="参考资料">参考资料</h3>
<ul>
<li><a href="http://blog.csdn.net/acdreamers/article/details/11309971" target="_blank" rel="noopener">ACdreamer的博客——Treap原理和实现方法</a></li>
<li><a href="http://dongxicheng.org/structure/treap/" target="_blank" rel="noopener">董的博客——数据结构之Treap</a></li>
<li><a href="http://blog.csdn.net/yang_yulei/article/details/46005845" target="_blank" rel="noopener">菜鸟的自留地——图文详解Treap</a></li>
<li><a href="http://www.nocow.cn/index.php/Treap" target="_blank" rel="noopener">NOCOW——Treap</a></li>
</ul>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2017/02/18/数据结构——平衡树 Treap/">数据结构——平衡树 Treap</a></p>
        <p><span>文章作者:</span><a href="/" title="回到主页">lzcwr</a></p>
        <p><span>发布时间:</span>2017-02-18, 22:02:59</p>
        <p><span>最后更新:</span>2018-03-16, 10:52:44</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2017/02/18/数据结构——平衡树 Treap/" title="数据结构——平衡树 Treap">http://lizhechen.com/2017/02/18/数据结构——平衡树 Treap/</a>
            <span class="copy-path" data-clipboard-text="原文: http://lizhechen.com/2017/02/18/数据结构——平衡树 Treap/　　作者: lzcwr" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2017/02/21/数据结构——树状数组 Binary Indexed Tree/">
                    数据结构——树状数组 Binary Indexed Tree
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2017/02/17/数据结构——线段树 Segment Tree/">
                    数据结构——线段树 Segment Tree
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#treap概述"><span class="toc-number">1.</span> <span class="toc-text">Treap概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#treap的结构"><span class="toc-number">2.</span> <span class="toc-text">Treap的结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#treap的操作"><span class="toc-number">3.</span> <span class="toc-text">Treap的操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#旋转"><span class="toc-number">3.1.</span> <span class="toc-text">旋转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#插入"><span class="toc-number">3.2.</span> <span class="toc-text">插入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查询"><span class="toc-number">3.3.</span> <span class="toc-text">查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除"><span class="toc-number">3.4.</span> <span class="toc-text">删除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#拆分"><span class="toc-number">3.5.</span> <span class="toc-text">拆分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#合并"><span class="toc-number">3.6.</span> <span class="toc-text">合并</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#treap模板"><span class="toc-number">4.</span> <span class="toc-text">Treap模板</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#acdreamer模板-poj-1442"><span class="toc-number">4.1.</span> <span class="toc-text">ACdreamer模板 (POJ 1442)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kuangbin模板-zoj-3765"><span class="toc-number">4.2.</span> <span class="toc-text">kuangbin模板 (ZOJ 3765)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#练习题目和参考资料"><span class="toc-number">5.</span> <span class="toc-text">练习题目和参考资料</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#练习题目"><span class="toc-number">5.1.</span> <span class="toc-text">练习题目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参考资料"><span class="toc-number">5.2.</span> <span class="toc-text">参考资料</span></a></li></ol></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"数据结构——平衡树 Treap　| Zhechen的博客　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2017/02/21/数据结构——树状数组 Binary Indexed Tree/" title="上一篇: 数据结构——树状数组 Binary Indexed Tree">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2017/02/17/数据结构——线段树 Segment Tree/" title="下一篇: 数据结构——线段树 Segment Tree">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/04/05/论文笔记-1-——Bogomolnaia2001A/">论文笔记[1]——A New Solution to the Random Assignmente Problem</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/01/北京大学数学科学学院2018年直博生考试题目/">北京大学数学科学学院2018年直博生考试题目</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/01/北京大学数学科学学院2016年直博生考试题目/">北京大学数学科学学院2016年直博生考试题目</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/28/数学分析拾遗-5-——多元函数的极值/">数学分析拾遗[5]——多元函数的极值</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/27/数学分析拾遗-4-——Abel判别法与Dirichlet判别法/">数学分析拾遗[4]——含参广义积分的一致收敛</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/22/线性代数拾遗-2-——Jordan标准型/">线性代数拾遗[2]——Jordan标准形</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/22/线性代数拾遗-1-——分块矩阵/">线性代数拾遗[1]——分块矩阵</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/20/hexo博客迁移/">hexo博客的傻瓜式迁移</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/18/数学分析拾遗-3-——隐函数定理/">数学分析拾遗[3]——隐函数定理</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/13/数学分析拾遗-2-——积分中值定理/">数学分析拾遗[2]——积分的中值定理</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/13/数学分析拾遗-1-——一些不等式/">数学分析拾遗[1]——一些不等式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/02/范畴论学习笔记/">范畴论学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/09/2018MCM乱搞/">2018MCM乱搞</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/11/北京师范大学2017年拓扑学期末考试试卷/">北京师范大学2017年拓扑学期末考试试卷</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/11/北京师范大学2017年泛函分析期末考试试卷/">北京师范大学2017年泛函分析期末考试试卷</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/08/拓扑学复习重点/">拓扑学复习重点</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/06/数理统计复习重点/">数理统计复习重点</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/02/测度与概率复习重点/">测度与概率复习重点</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/24/泛函——复习重点/">泛函——复习重点</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/20/北京师范大学2017年概率测度小测二题目/">北京师范大学2017年概率测度小测二题目</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/05/明月杯回忆录/">明月杯回忆录</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/17/2016-2017学年春季学期志愿时长录入/">2016-2017学年春季学期志愿时长录入</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/25/泛函——有界集、完全有界集和紧集/">泛函——有界集、完全有界集和紧集</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/19/北京师范大学2017年概率测度小测一题目/">北京师范大学2017年概率测度小测一题目</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/09/次序统计量的联合分布/">次序统计量的联合分布</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/08/泛函——自然数集上的Lp范数/">泛函——自然数集上的Lp范数</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/08/拓扑学题目/">拓扑学题目</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/21/单调类定理/">单调类定理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/17/数理统计基础知识/">数理统计基础知识</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/25/GRE阅读题目分析[4]/">GRE阅读题目分析[4]</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/24/GRE填空思路分析[3]——推理的线索来源·同义线索/">GRE填空思路分析[3]——推理的线索来源·同义线索</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/23/GRE阅读题目分析[3]/">GRE阅读题目分析[3]</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/20/GRE填空思路分析[2]——推理的线索来源·反义线索/">GRE填空思路分析[2]——推理的线索来源·反义线索</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/20/GRE填空思路分析[1]/">GRE填空思路分析[1]——词句推理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/16/GRE阅读题目分析[2]/">GRE阅读题目分析[2]</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/16/GRE阅读题目分析[1]/">GRE阅读题目分析[1]</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/04/北京师范大学2015年数学分析期末考试试卷/">北京师范大学2015年数学分析期末考试试卷</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/04/北京师范大学2016年高等代数期中考试试卷/">北京师范大学2016年高等代数期中考试试卷</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/04/北京师范大学2016年数学分析期中考试试卷/">北京师范大学2016年数学分析期中考试试卷</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/03/北京师范大学2016年数学分析期末考试试卷/">北京师范大学2016年数学分析期末考试试卷</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/03/北京师范大学2016年近世代数期末考试试卷/">北京师范大学2016年近世代数期末考试试卷</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/03/北京师范大学2016年近世代数期中考试试卷/">北京师范大学2016年近世代数期中考试试卷</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/02/北京师范大学2017年实变函数期末考试试卷/">北京师范大学2017年实变函数期末考试试卷</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/02/北京师范大学2017年复变函数期末考试试卷/">北京师范大学2017年复变函数期末考试试卷</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/24/组合数学复习重点/">组合数学复习重点</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/23/微分几何复习重点/">微分几何复习重点</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/23/概率论复习重点/">概率论复习重点</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/22/复变复习重点/">复变复习重点</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/14/北京师范大学2015年复变函数期末考试试卷/">北京师范大学2015年复变函数期末考试试卷</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/14/北京师范大学2011年概率论期末考试试卷/">北京师范大学2011年概率论期末考试试卷</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/11/北京师范大学2016年高等代数期末考试试卷/">北京师范大学2016年高等代数期末考试试卷</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/11/北京师范大学2017年复变函数期中考试试卷/">北京师范大学2017年复变函数期中考试试卷</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/09/Mathematica技巧[2]——修改输入和输出字体/">Mathematica技巧[2]——修改输入和输出字体</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/13/几篇TOEFL独立写作范文/">几篇TOEFL独立写作范文</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/04/LaTeX技巧[2]——打生僻字/">LaTeX技巧[1]——打生僻字</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/04/LaTeX技巧[1]——修改数学公式字体/">LaTeX技巧[2]——修改数学公式字体</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/21/组合杂题/">组合杂题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/10/一些概率论题目/">一些概率论题目</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/09/一些实变函数题目/">一些实变函数题目</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/08/Hexo与Mathjax的冲突及（部分）解决/">Hexo与Mathjax的冲突及（部分）解决</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/08/数学系转专业考试题及解答不完全版（2015-04）/">数学系转专业考试题及解答不完全版（2015.04）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/21/数据结构——树状数组 Binary Indexed Tree/">数据结构——树状数组 Binary Indexed Tree</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/18/数据结构——平衡树 Treap/">数据结构——平衡树 Treap</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/17/数据结构——线段树 Segment Tree/">数据结构——线段树 Segment Tree</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/16/Mathematica技巧[1]——图像复原与处理/">Mathematica技巧[1]——图像复原与处理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/12/github-hexo-搭建个人博客/">github+hexo 搭建个人博客</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2017-2018 lzcwr
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
    <script src="/js/GithubRepoWidget.js"></script>

<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>





    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
             github: ".github-widget a", 
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

    <script>
        var originTitle = document.title;
        var titleTime;
        document.addEventListener("visibilitychange", function() {
            if (document.hidden) {
                document.title = "(つェ⊂) " + originTitle;
                clearTimeout(titleTime);
            }
            else {
                document.title = "(*´∇｀*) " + originTitle;
                titleTime = setTimeout(function() {
                    document.title = originTitle;
                }, 2000);
            }
        })
    </script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>